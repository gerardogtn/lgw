<form class="container" method="post" action="/login">
  <div class="form-group">
    <label for="username">Username</label>
    <input id="username" required name="username" placeholder="Username"></input>
  </div>

  <div class="form-group">
    <label for="password">Password</label>
    <input id="password" required name="password" placeholder="Password" type="password"></input>
  </div>

  <button type="submit" class="btn btn-default" onclick="sending(event)">Log in</button>
</form>

<div id="cannotLogin" class="alert alert-dismissable" hidden="hidden">
  <button type="button" class="close" data-dismiss="alert"></button>
  <p>Cannot login</p>
</div>

<div id="error" class="alert alert-dismissable" hidden="hidden">
  <button type="button" class="close" data-dismiss="alert"></button>
  <p>There was an error</p>
</div>

{{#section 'jquery'}}
<script>
  function sending(evt){
		evt.preventDefault(); // Avoid redirection.
		var action = "./login";

    var username = $('#username').val();
    var password = $('#password').val();
		$.ajax({
			type: 'POST',
			url: action,
			dataType: 'json',
      data: {username: username, password: password},

			success: function(data){
				if(data.status){
					window.location.href = "./";
				} else {
          $('#cannotLogin').show();
          $('#error').hide();
				}
			},
			error: function(){
				console.log("ERROR");
        $('#error').show();
        $('#cannotLogin').hide();
			}
		});
	}
</script>

{{/section}}
